# AIBRO Business - Полная документация

## Содержание

1. [Обзор проекта](#обзор-проекта)
2. [Архитектура](#архитектура)
3. [Установка и запуск](#установка-и-запуск)
4. [Безопасность](#безопасность)
5. [Производительность](#производительность)
6. [Доступность](#доступность)
7. [Тестирование](#тестирование)
8. [Развертывание](#развертывание)
9. [Мониторинг и аналитика](#мониторинг-и-аналитика)
10. [Лучшие практики](#лучшие-практики)

## Обзор проекта

AIBRO Business - это комплексная система автоматизации малого и среднего бизнеса, полностью интегрированная в Telegram. Система предоставляет набор инструментов на основе искусственного интеллекта для автоматизации различных аспектов бизнеса: создание контента, управление заказами, бронирование, обратная связь и многое другое.

## Архитектура

### Frontend (React + TypeScript + Vite)

```
React + TypeScript + TailwindCSS + Vite
├── src/
│   ├── components/              # Компоненты UI
│   │   ├── common/              # Общие компоненты
│   │   │   ├── Button.tsx        # Кнопка с доступностью
│   │   │   ├── SafeHTML.tsx     # Безопасный HTML компонент
│   │   │   ├── OptimizedImage.tsx # Оптимизированное изображение
│   │   │   ├── Skeleton.tsx     # Компоненты заглушек
│   │   │   ├── Modal.tsx        # Модальное окно
│   │   │   └── ...
│   │   └── sections/            # Секции страницы
│   ├── context/                 # React контексты
│   ├── hooks/                   # Пользовательские хуки
│   ├── i18n/                    # Локализация
│   ├── lib/                     # Библиотеки
│   │   ├── analytics/           # Служба аналитики
│   │   ├── monitoring/          # Служба мониторинга
│   │   ├── utils/               # Утилиты
│   │   │   ├── storage.ts       # Хранилище
│   │   │   ├── dom.ts           # DOM утилиты
│   │   │   ├── validators.ts    # Валидаторы
│   │   │   └── ...
│   │   ├── validation/          # Zod схемы
│   │   │   └── auth.ts          # Схемы аутентификации
│   │   ├── queryClient.ts       # Конфигурация React Query
│   │   └── toast.ts             # Служба уведомлений
│   ├── pages/                   # Страницы приложения
│   └── services/                # API сервисы
├── public/                      # Публичные ресурсы
├── docs/                        # Документация
├── assets/                      # Изображения
├── package.json                # Зависимости
└── README.md                   # Документация
```

### Backend (Express + TypeScript + Prisma)

```
Express.js + TypeScript + Prisma
├── backend/
│   ├── src/
│   │   ├── config/              # Конфигурация
│   │   ├── controllers/         # Бизнес-логика
│   │   ├── middleware/          # Middleware
│   │   ├── models/              # TypeScript типы
│   │   ├── routes/              # API маршруты
│   │   ├── services/            # Сервисные слои
│   │   ├── utils/               # Утилиты
│   │   └── prisma/              # Схема БД и миграции
│   ├── prisma/
│   │   ├── schema.prisma        # Схема БД
│   │   ├── seed.ts              # Сиды данных
│   │   └── migrations/          # Миграции
│   └── package.json
```

### Слои приложения

#### Frontend Layers:
- **UI Layer**: Компоненты интерфейса
- **Presentation Layer**: Управление состоянием представления
- **Service Layer**: API клиенты и интеграции
- **Utils Layer**: Вспомогательные функции

#### Backend Layers:
- **API Layer**: Контроллеры и маршруты
- **Service Layer**: Бизнес-логика
- **Data Layer**: Работа с базой данных
- **Config Layer**: Конфигурация сервисов

## Установка и запуск

### Требования
- Node.js 18+
- npm или yarn
- Git

### Установка

1. Клонируйте репозиторий:
```bash
git clone <ваш_репозиторий>
cd AIRBRO
```

2. Установите зависимости для фронтенда:
```bash
npm install
```

3. Установите зависимости для бэкенда:
```bash
cd backend
npm install
```

4. Создайте файлы .env (см. .env.example)

5. Запустите приложение:
- Backend: `npm run dev` (в папке backend)
- Frontend: `npm run dev` (в корне проекта)

### Конфигурация

#### Frontend переменные (`.env`)
```
VITE_API_URL=http://localhost:3000/api
VITE_SENTRY_DSN=https://your-sentry-dsn
VITE_GA_MEASUREMENT_ID=GA-XXXXXXXXX-XX
```

#### Backend переменные (backend/.env)
```
NODE_ENV=development
PORT=3000
FRONTEND_URL=http://localhost:5173
DATABASE_URL="file:./dev.db"
JWT_SECRET=ваш_32_символьный_секретный_ключ
TELEGRAM_BOT_TOKEN=ваш_токен_бота
TELEGRAM_ADMIN_CHANNEL=ваш_ID_канала
USDT_TRC20_WALLET=ваш_USDT_TRC20_адрес
USDT_ERC20_WALLET=ваш_USDT_ERC20_адрес
TON_WALLET=ваш_TON_адрес
```

## Безопасность

### Frontend безопасность
- **XSS Protection**: DOMPurify для очистки HTML
- **Валидация Zod**: Для всех форм и входных данных
- **JWT токены**: С ограниченным сроком действия
- **Защита токенов**: Хранение в localStorage с безопасными практиками
- **Валидация схем**: Все данные валидируются до отправки на сервер

### Backend безопасность
- **JWT аутентификация**: С токенами с коротким сроком действия
- **bcrypt**: Для шифрования паролей (10 раундов)
- **express-validator**: Для валидации входных данных
- **rate limiting**: Защита от DDoS атак
- **CORS**: Ограничения для безопасности
- **Helmet**: HTTP заголовки безопасности
- **Input sanitization**: express-validator для очистки данных
- **SQL injection protection**: Присма ORM

### Практики безопасности
- Никогда не хранить токены в коде
- Использовать .env файлы для секретов
- Регулярно обновлять зависимости
- Проводить аудит безопасности
- Использовать HTTPS в продакшене
- Правильно обрабатывать ошибки

## Производительность

### Оптимизации
- **Ленивая загрузка**: Lazy loading компонентов и страниц
- **Оптимизация изображений**: WebP/AVIF форматы и автоматические размеры
- **Состояние загрузки**: Skeleton компоненты для плавного UX
- **Мемоизация**: React.memo, useMemo, useCallback
- **Серверное состояние**: React Query для управления кэшем
- **PWA**: Кэширование и offline режим
- **Code splitting**: Разделение кода для быстрой загрузки
- **Tree shaking**: Удаление неиспользуемого кода
- **Bundle optimization**: Минимизация размера сборки

### Инструменты производительности
- **React Query**: Управление серверным состоянием
- **React Hook Form**: Управление формами
- **Framer Motion**: Плавные анимации
- **Image optimization**: Lazy loading и форматы
- **Service workers**: Кэширование ресурсов

## Доступность

### A11y особенности
- **Semantic HTML**: Использование правильных тегов
- **ARIA атрибуты**: Для доступности интерфейса
- **Клавиатурная навигация**: Полная поддержка
- **Screen reader support**: Поддержка программ чтения
- **Color contrast**: Соответствие стандартам WCAG
- **Skip navigation**: Ссылки для пропуска навигации
- **Focus management**: Правильное управление фокусом
- **Alt тексты**: Для всех изображений

### Тестирование доступности
- Использование axe-core для проверки
- Визуальная проверка на разных устройствах
- Тестирование с использованием скринридеров
- Проверка цветового контраста

## Тестирование

### Типы тестов
- **Unit тесты**: Для утилит и хуков
- **Integration тесты**: Для компонентов
- **API тесты**: Для серверных эндпоинтов
- **E2E тесты**: Для ключевых пользовательских сценариев

### Инструменты
- **Vitest**: Для unit и integration тестов
- **React Testing Library**: Для тестирования компонентов
- **Testing Library**: Для хуков
- **SuperTest**: Для API тестов
- **Cypress**: Для E2E тестирования

### Покрытие
- Утилиты: 100%
- Хуки: >90%
- API клиенты: >95%
- Валидационные схемы: 100%

## Развертывание

### Frontend (Vercel)
- Подключите репозиторий к Vercel
- Укажите команду сборки: `npm run build`
- Укажите директорию вывода: `dist`
- Добавьте переменные окружения

### Backend (Railway/Render)
- Загрузите backend в деплой-платформу
- Настройте переменные окружения
- Подключите базу данных
- Настройте домен

### CI/CD
- Автоматические тесты на каждый push
- Линтинг и проверка типов
- Автоматический деплой на продакшен
- Уведомления о статусе деплоя

## Мониторинг и аналитика

### Sentry
- Отслеживание ошибок в продакшене
- Мониторинг производительности
- Уведомления об ошибках
- Сбор метрик пользовательского опыта

### Google Analytics
- Отслеживание пользовательского поведения
- Конверсии и метрики
- Аналитика событий
- Демографические данные

### Логирование
- Winston для backend
- Консольное логирование
- Файловое логирование
- Уведомления в Telegram

## Лучшие практики

### Код
- Чистый код с принципами SOLID
- Типобезопасность через TypeScript
- Единообразный стиль кода
- Использование ESLint и Prettier
- Комментарии к сложной логике
- Документирование публичных API

### Архитектура
- Четкое разделение ответственностей
- Модульность и переиспользуемость
- Простота тестирования
- Масштабируемость и поддерживаемость
- Безопасность по умолчанию
- Производительность из коробки