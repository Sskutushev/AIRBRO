# 7. CI/CD (Непрерывная интеграция и доставка)

Процессы CI/CD в проекте AIRBRO Business настроены с помощью **GitHub Actions**. Они обеспечивают автоматическую проверку качества кода, сборку и развертывание приложения, минимизируя риск ошибок в продакшене.

## Основные воркфлоу

В проекте настроено три основных воркфлоу:

1.  **`ci.yml`**: Основной CI-пайплайн, проверяющий качество кода при каждом push.
2.  **`security.yml`**: Пайплайн для сканирования безопасности.
3.  **`deploy-*.yml`**: Пайплайны для развертывания фронтенда и бэкенда.

---

### 1. `ci.yml` - Непрерывная интеграция

Этот воркфлоу запускается при каждом `push` или `pull request` в ветки `main` и `develop`. Его задача — убедиться, что изменения не нарушают работоспособность и соответствуют стандартам качества.

**Задачи (Jobs):**

- **`lint` (Линтинг и форматирование):**
  - Проверяет код на соответствие правилам ESLint.
  - Проверяет форматирование кода с помощью Prettier.
  - **Цель:** Поддержание единого стиля кода и отлов синтаксических ошибок.

- **`typecheck` (Проверка типов TypeScript):**
  - Выполняет команду `tsc --noEmit` для фронтенда и бэкенда.
  - **Цель:** Гарантировать, что во всем проекте нет ошибок типизации.

- **`test` (Юнит-тесты):**
  - Запускает юнит- и интеграционные тесты с помощью `vitest`.
  - Собирает отчет о покрытии кода тестами (`coverage`).
  - Загружает отчет о покрытии в [Codecov](https://about.codecov.io/).
  - **Цель:** Убедиться, что существующая бизнес-логика работает корректно.

- **`build` (Проверка сборки):**
  - Выполняет продакшн-сборку фронтенда (`npm run build`) и бэкенда.
  - Проверяет, что итоговый размер бандла фронтенда не превышает установленный лимит (20 МБ).
  - **Цель:** Убедиться, что проект успешно собирается для продакшена.

- **`e2e` (End-to-End тесты):**
  - _На данный момент эта задача закомментирована и не выполняется._
  - В будущем она будет запускать сквозные тесты с помощью Playwright, которые имитируют действия реального пользователя в браузере.

---

### 2. `security.yml` - Сканирование безопасности

Этот воркфлоу запускается еженедельно, а также при каждом `push` в `main`.

**Задачи (Jobs):**

- **`audit` (Аудит зависимостей):**
  - Выполняет `npm audit` для фронтенда и бэкенда.
  - **Цель:** Обнаружение известных уязвимостей в используемых npm-пакетах.

- **`snyk` (Сканирование Snyk):**
  - Использует Snyk для более глубокого анализа уязвимостей в коде и зависимостях.
  - **Цель:** Комплексная проверка безопасности проекта.

- **`codeql` (Анализ CodeQL):**
  - Использует инструмент статического анализа от GitHub для поиска потенциальных уязвимостей и ошибок в коде.
  - **Цель:** Поиск сложных уязвимостей, таких как SQL-инъекции, XSS и др.

- **`secrets` (Сканирование секретов):**
  - Использует TruffleHog для поиска случайно закоммиченных секретов (API-ключей, паролей) в истории Git.
  - **Цель:** Предотвращение утечки конфиденциальных данных.

---

### 3. `deploy-frontend.yml` и `deploy-backend.yml`

Эти воркфлоу отвечают за развертывание приложений. Подробно они описаны в разделе **[06 - Деплой](./06_Deployment.md)**.

---

**Далее:** [08 - Тестирование](./08_Testing.md)
